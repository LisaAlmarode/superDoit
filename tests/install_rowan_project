#!/usr/bin/env superdoit_home
options
{
  SuperDoitCommandLineOption long: 'help' short: 'h'.
  SuperDoitCommandLineOption long: 'debug' short: 'D'.
}
%
usage
-----
USAGE $basename <stone-name> [--help | -h] [--debug | -D] <rowan-load-spec-url>

DESCRIPTION
  Load the project referenced by the <rowan-load-spec-url> into the given
    GsDevKit_home stone. The stone must have Rowan installed, prior to running
    the script.

OPTIONS
  <stone-name>               Name of the stone.
  <rowan-load-spec-url>      url pointing to a Rowan load spec
  -h, --help                 display usage message
  -D, --debug                bring up topaz debugger in the event of a script error

EXAMPLES
  $basename --help
  $basename -h
  $basename rowan_test_stats_l -D file:$GS_HOME/shared/repos/GsTestStats/rowan/specs/GsTestStats.ston
  $basename rowan_test_stats_l file:$GS_HOME/shared/repos/GsTestStats/rowan/specs/GsTestStats.ston
-----
%
method
getAndVerifyOptions
		self getOpts: self optionSpecs.
		self help ifTrue: [ ^ self usage ].
		self positionalArgs size < 1 
			ifTrue: [self error: 'Missing positional argument  <rowan-load-spec-url>'].
%
doit
	[
		self getAndVerifyOptions == self noResult
			ifTrue: [ ^ self noResult ].
		(Rowan projectFromUrl: (self positionalArgs at: 1))
			load.
	^ System commit
	] on: Error do: [:ex | 
		self debug ifTrue: [ ex pass ].
		self exit: ex description withStatus: 1 "does not return" ].
%

